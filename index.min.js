import { Octokit } from './github-api.js';

const form = document.getElementById('user-info-form');
form.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const birthdate = document.getElementById('birthdate').value;
    const userInfo = {
        'name':name,
        'email':email,
        'birthdate':birthdate
    };

    const octokit = Octokit.getInstance();
    async function createIssue(userInfo) {
        // todo: validate the user info 

        const repoOwner = 'ProxyAyush';
        const repoName = 'eatcha';


        const newIssue = await octokit.issuesCreate({
            owner: repoOwner,
            repo: repoName,
            title: 'New user info',
            body: `Here is the new user info: \n${JSON.stringify(userInfo)}`
        });
        console.log('New Issue:',newIssue);
        document.getElementById('thank-you-message').innerText = `Thank you for submitting your information, ${name}!`;

    }

    createIssue(userInfo);
});
