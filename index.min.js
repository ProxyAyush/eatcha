import { Octokit } from 'https://cdn.jsdelivr.net/npm/octokit@4.0.2/dist-src/index.js';

const form = document.getElementById('user-info-form');
form.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const birthdate = document.getElementById('birthdate').value;
    const userInfo = {
        'name':name,
        'email':email,
        'birthdate':birthdate
    };

    async function createIssue(userInfo) {
        // todo: validate the user info 

        const octokit = new Octokit.Octokit({
            baseUrl: 'https://api.github.com',
            accessToken: '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'
        });
        const repoOwner = 'ProxyAyush';
        const repoName = 'eatcha';

        const newIssue = await octokit.issues.create({
            owner: repoOwner,
            repo: repoName,
            title: 'New user info',
            body: `Here is the new user info: \n${JSON.stringify(userInfo)}`
        });
        console.log('New Issue:',newIssue);
    }

    createIssue(userInfo);
    document.getElementById('thank-you-message').innerText = `Thank you for submitting your information, ${name}!`;
});